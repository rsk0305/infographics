<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>대화형 차량 유지비 비교 인포그래픽</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f9;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: auto;
            background: #fff;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        h1, h2 {
            text-align: center;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .input-section, .vehicle-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #ecf0f1;
            border-radius: 8px;
        }
        .input-group, .vehicle-card {
            background: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .vehicle-card h3 {
            margin-top: 0;
            color: #3498db;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        input[type="number"], input[type="text"] {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 1rem;
        }
        .unit {
            font-size: 0.9em;
            color: #777;
            margin-left: 5px;
        }
        .chart-container {
            width: 100%;
            margin-top: 30px;
        }
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .results-table th, .results-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: right;
        }
        .results-table th {
            background-color: #34495e;
            color: white;
            text-align: center;
        }
        .results-table td:first-child {
            text-align: left;
            font-weight: bold;
        }
        .highlight {
            font-weight: bold;
            color: #e74c3c;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>대화형 차량 유지비 비교 인포그래픽 (10년 기준)</h1>

        <h2>1. 기본 조건 입력</h2>
        <div class="input-section">
            <div class="input-group">
                <label for="annual-mileage">연간 주행거리</label>
                <input type="number" id="annual-mileage" value="15000">
                <span class="unit">km</span>
            </div>
            <div class="input-group">
                <label for="gasoline-price">가솔린 유류비</label>
                <input type="number" id="gasoline-price" value="1650">
                <span class="unit">원/L</span>
            </div>
            <div class="input-group">
                <label for="diesel-price">디젤 유류비</label>
                <input type="number" id="diesel-price" value="1450">
                <span class="unit">원/L</span>
            </div>
            <div class="input-group">
                <label for="electric-price">전기 충전요금</label>
                <input type="number" id="electric-price" value="240">
                <span class="unit">원/kWh</span>
            </div>
        </div>

        <h2>2. 차량 정보 입력</h2>
        <div class="vehicle-section">
            <div class="vehicle-card" id="vehicle1">
                <input type="text" class="vehicle-name" value="카니발 2.2 디젤 (중고)">
                <label>초기 구매가 <span class="unit">(원)</span></label>
                <input type="number" class="purchase-price" value="45000000">
                <label>연비 <span class="unit">(km/L)</span></label>
                <input type="number" class="economy" value="13.1">
                <label>10년 자동차세 <span class="unit">(원)</span></label>
                <input type="number" class="tax-10y" value="4828751">
                <label>10년 정비/소모품비 <span class="unit">(원)</span></label>
                <input type="number" class="maint-10y" value="8000000">
                <input type="hidden" class="fuel-type" value="diesel">
            </div>
            <div class="vehicle-card" id="vehicle2">
                <input type="text" class="vehicle-name" value="카니발 3.5 가솔린 (신차)">
                <label>초기 구매가 <span class="unit">(원)</span></label>
                <input type="number" class="purchase-price" value="52000000">
                <label>연비 <span class="unit">(km/L)</span></label>
                <input type="number" class="economy" value="9">
                <label>10년 자동차세 <span class="unit">(원)</span></label>
                <input type="number" class="tax-10y" value="8389860">
                <label>10년 정비/소모품비 <span class="unit">(원)</span></label>
                <input type="number" class="maint-10y" value="9000000">
                <input type="hidden" class="fuel-type" value="gasoline">
            </div>
            <div class="vehicle-card" id="vehicle3">
                <input type="text" class="vehicle-name" value="팰리세이드 2.5 하이브리드 (신차)">
                <label>초기 구매가 <span class="unit">(원)</span></label>
                <input type="number" class="purchase-price" value="65000000">
                <label>연비 <span class="unit">(km/L)</span></label>
                <input type="number" class="economy" value="13">
                <label>10년 자동차세 <span class="unit">(원)</span></label>
                <input type="number" class="tax-10y" value="5534601">
                <label>10년 정비/소모품비 <span class="unit">(원)</span></label>
                <input type="number" class="maint-10y" value="9000000">
                <input type="hidden" class="fuel-type" value="gasoline">
            </div>
            <div class="vehicle-card" id="vehicle4">
                <input type="text" class="vehicle-name" value="EV9 (신차)">
                <label>초기 구매가 <span class="unit">(원)</span></label>
                <input type="number" class="purchase-price" value="75000000">
                <label>전비 <span class="unit">(km/kWh)</span></label>
                <input type="number" class="economy" value="5">
                <label>10년 자동차세 <span class="unit">(원)</span></label>
                <input type="number" class="tax-10y" value="1300000">
                <label>10년 정비/소모품비 <span class="unit">(원)</span></label>
                <input type="number" class="maint-10y" value="4000000">
                <input type="hidden" class="fuel-type" value="electric">
            </div>
            <div class="vehicle-card" id="vehicle5">
                 <input type="text" class="vehicle-name" value="IONIQ 9 (신차)">
                <label>초기 구매가 <span class="unit">(원)</span></label>
                <input type="number" class="purchase-price" value="75000000">
                <label>전비 <span class="unit">(km/kWh)</span></label>
                <input type="number" class="economy" value="5">
                <label>10년 자동차세 <span class="unit">(원)</span></label>
                <input type="number" class="tax-10y" value="1300000">
                <label>10년 정비/소모품비 <span class="unit">(원)</span></label>
                <input type="number" class="maint-10y" value="4000000">
                <input type="hidden" class="fuel-type" value="electric">
            </div>
        </div>
        
        <h2>3. 분석 결과 (10년)</h2>
        <table class="results-table">
            <thead>
                <tr>
                    <th>항목</th>
                    <th id="th-v1">차량1</th>
                    <th id="th-v2">차량2</th>
                    <th id="th-v3">차량3</th>
                    <th id="th-v4">차량4</th>
                    <th id="th-v5">차량5</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>10년 유류비</td>
                    <td id="res-fuel-v1"></td>
                    <td id="res-fuel-v2"></td>
                    <td id="res-fuel-v3"></td>
                    <td id="res-fuel-v4"></td>
                    <td id="res-fuel-v5"></td>
                </tr>
                <tr>
                    <td>10년 총 유지비</td>
                    <td id="res-maint-v1"></td>
                    <td id="res-maint-v2"></td>
                    <td id="res-maint-v3"></td>
                    <td id="res-maint-v4"></td>
                    <td id="res-maint-v5"></td>
                </tr>
                <tr style="background-color: #f2f2f2;">
                    <td class="highlight">차량가+10년 총 비용</td>
                    <td class="highlight" id="res-total-v1"></td>
                    <td class="highlight" id="res-total-v2"></td>
                    <td class="highlight" id="res-total-v3"></td>
                    <td class="highlight" id="res-total-v4"></td>
                    <td class="highlight" id="res-total-v5"></td>
                </tr>
            </tbody>
        </table>

        <div class="chart-container">
            <h2>결과 비교 그래프</h2>
            <canvas id="maintenanceChart"></canvas>
            <canvas id="totalCostChart" style="margin-top: 30px;"></canvas>
        </div>
    </div>

    <script>
        // 전역 변수로 차트 객체 선언
        let maintChart, totalChart;

        function formatCurrency(num) {
            return new Intl.NumberFormat('ko-KR').format(num) + ' 원';
        }

        function calculate() {
            // 기본 조건 값 가져오기
            const mileage = parseFloat(document.getElementById('annual-mileage').value);
            const prices = {
                gasoline: parseFloat(document.getElementById('gasoline-price').value),
                diesel: parseFloat(document.getElementById('diesel-price').value),
                electric: parseFloat(document.getElementById('electric-price').value)
            };

            const results = [];
            const vehicleCards = document.querySelectorAll('.vehicle-card');
            
            // 테이블 헤더 이름 업데이트
            vehicleCards.forEach((card, i) => {
                const vehicleName = card.querySelector('.vehicle-name').value;
                document.getElementById(`th-v${i+1}`).textContent = vehicleName;
            });

            // 각 차량별 계산
            vehicleCards.forEach((card, i) => {
                const purchasePrice = parseFloat(card.querySelector('.purchase-price').value);
                const economy = parseFloat(card.querySelector('.economy').value);
                const tax10y = parseFloat(card.querySelector('.tax-10y').value);
                const maint10y = parseFloat(card.querySelector('.maint-10y').value);
                const fuelType = card.querySelector('.fuel-type').value;

                if (economy === 0) return; // 0으로 나누기 방지

                const fuelPrice = prices[fuelType];
                const fuelCost10y = (mileage / economy) * fuelPrice * 10;
                const totalMaint10y = fuelCost10y + tax10y + maint10y;
                const grandTotal = purchasePrice + totalMaint10y;
                
                // 결과 UI 업데이트
                document.getElementById(`res-fuel-v${i+1}`).textContent = formatCurrency(Math.round(fuelCost10y));
                document.getElementById(`res-maint-v${i+1}`).textContent = formatCurrency(Math.round(totalMaint10y));
                document.getElementById(`res-total-v${i+1}`).textContent = formatCurrency(Math.round(grandTotal));

                results.push({
                    name: card.querySelector('.vehicle-name').value,
                    maintCost: totalMaint10y,
                    totalCost: grandTotal
                });
            });

            updateCharts(results);
        }

        function updateCharts(results) {
            const labels = results.map(r => r.name);
            const maintData = results.map(r => r.maintCost);
            const totalData = results.map(r => r.totalCost);

            // 유지비 차트
            const maintCtx = document.getElementById('maintenanceChart').getContext('2d');
            if(maintChart) maintChart.destroy(); // 이전 차트 파괴
            maintChart = new Chart(maintCtx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '10년 총 유지비 (차량가 제외)',
                        data: maintData,
                        backgroundColor: 'rgba(52, 152, 219, 0.8)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value, index, values) {
                                    return (value / 10000).toLocaleString('ko-KR') + ' 만원';
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + (context.raw / 10000).toLocaleString('ko-KR') + ' 만원';
                                }
                            }
                        }
                    }
                }
            });

            // 총 비용 차트
            const totalCtx = document.getElementById('totalCostChart').getContext('2d');
            if(totalChart) totalChart.destroy(); // 이전 차트 파괴
            totalChart = new Chart(totalCtx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '차량가 + 10년 총 비용',
                        data: totalData,
                        backgroundColor: 'rgba(231, 76, 60, 0.8)',
                        borderColor: 'rgba(231, 76, 60, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value, index, values) {
                                    return (value / 10000).toLocaleString('ko-KR') + ' 만원';
                                }
                            }
                        }
                    },
                     plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + (context.raw / 10000).toLocaleString('ko-KR') + ' 만원';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // 모든 input 요소에 이벤트 리스너 추가
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('input', calculate);
        });

        // 페이지 로드 시 초기 계산 실행
        window.onload = calculate;
    </script>
</body>
</html>
